:root {
  color-scheme: light;
  font-family: "Inter", "Segoe UI", system-ui, -apple-system, sans-serif;
  background: #f4f6fb;
  color: #1f2430;
  --schema-class: #3f9aae;
  --schema-subclass: #5d76d3;
  --schema-attribute: #79c9c5;
  --schema-id: #ffe2af;
  --schema-instance: #6c7dd6;
  --schema-core-instance: #8f6bd9;
  --schema-relationship: #f96e5b;
}

*,
*::before,
*::after {
  box-sizing: border-box;
}

body {
  margin: 0;
  height: 100vh;
  overflow: hidden;
}

.app-layout {
  display: flex;
  height: 100vh;
}

.main-menu {
  position: absolute;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  padding: 2rem;
  background: radial-gradient(circle at top, #f7f9ff 0%, #eef1f9 55%, #e2e6f3 100%);
  z-index: 2;
}

.main-menu[hidden] {
  display: none !important;
}

.main-menu__panel {
  width: min(720px, 100%);
  background: rgba(255, 255, 255, 0.96);
  border-radius: 24px;
  padding: 2.5rem;
  border: 1px solid #d6dcec;
  box-shadow: 0 24px 48px rgba(31, 36, 48, 0.18);
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  text-align: center;
}

.main-menu__eyebrow {
  margin: 0;
  font-size: 0.8rem;
  letter-spacing: 0.3em;
  text-transform: uppercase;
  color: #647197;
  font-weight: 600;
}

.main-menu__panel h1 {
  margin: 0;
  font-size: clamp(1.8rem, 2.4vw, 2.4rem);
  color: #1f2430;
}

.main-menu__subtitle {
  margin: 0;
  color: #4c5672;
}

.main-menu__actions {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 1rem;
}

.main-menu__button {
  padding: 1.4rem 1.5rem;
  font-size: 1.1rem;
  font-weight: 700;
  border-radius: 18px;
  border: 2px solid transparent;
  background: #ffffff;
  color: #1f2430;
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
}

.main-menu__button--primary {
  background: linear-gradient(135deg, #4e68d8 0%, #7a6be2 100%);
  color: #f8f9ff;
  border-color: #4e68d8;
  box-shadow: 0 14px 24px rgba(78, 104, 216, 0.3);
}

.main-menu__button:hover {
  transform: translateY(-2px);
}

.main-menu__options {
  text-align: left;
  border-top: 1px solid #e2e6f3;
  padding-top: 1.5rem;
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.main-menu__options h2 {
  margin: 0;
  font-size: 1rem;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: #677193;
}

.main-menu__option-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 1rem;
  padding: 0.85rem 1rem;
  background: #f2f4fb;
  border-radius: 14px;
  font-weight: 600;
  color: #2b3245;
}

.main-menu__option-row button {
  padding: 0.4rem 0.8rem;
  border-radius: 999px;
  border: 1px solid #c8d1e3;
  background: #ffffff;
  font-weight: 600;
  cursor: pointer;
}

.main-menu__option-row--placeholder button {
  cursor: not-allowed;
  opacity: 0.6;
}

.sidebar {
  width: 20%;
  min-width: 220px;
  background: #ffffff;
  border-right: 1px solid #e4e7ef;
  padding: 1rem;
  display: flex;
  flex-direction: column;
  gap: 1.25rem;
  z-index: 3;
}

.sidebar__brand {
  font-size: 1.1rem;
  font-weight: 700;
  color: #2b3245;
}

.sidebar__app-name {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 1.6rem;
  letter-spacing: 0.03em;
}

.sidebar__section {
  display: flex;
  flex-direction: column;
  gap: 0.6rem;
}

.sidebar__section--budget {
  display: none;
}

.sidebar__budget-tools {
  display: grid;
  gap: 0.6rem;
}

.sidebar button {
  padding: 0.55rem 0.75rem;
  border-radius: 8px;
  border: 1px solid #c8d1e3;
  background: #f8f9ff;
  font-weight: 600;
  cursor: pointer;
  width: 100%;
}

.sidebar button:hover {
  border-color: #7f93d9;
}

body[data-tooltips="true"] [data-tooltip] {
  position: relative;
}

body[data-tooltips="true"] [data-tooltip]:hover::after {
  content: attr(data-tooltip);
  position: absolute;
  left: calc(100% + 12px);
  top: 50%;
  transform: translateY(-50%);
  background: rgba(31, 36, 48, 0.96);
  color: #f8f9ff;
  padding: 0.45rem 0.6rem;
  border-radius: 8px;
  font-size: 0.75rem;
  white-space: nowrap;
  z-index: 5;
  pointer-events: none;
  box-shadow: 0 8px 18px rgba(31, 36, 48, 0.25);
}

.sidebar__label {
  font-size: 0.85rem;
  color: #3b4256;
  margin: 0 0 0.35rem;
  text-transform: uppercase;
  letter-spacing: 0.04em;
}

.sidebar__status {
  font-size: 0.9rem;
  color: #5b6482;
}

body[data-view="budget"] .sidebar__section--vefa,
body[data-view="budget"] .sidebar__divider--vefa,
body[data-view="budget"] .sidebar__status {
  display: none;
}

body[data-view="budget"] .sidebar__section--budget {
  display: flex;
}

body[data-view="budget"] .mini-toolbar {
  display: none;
}

body[data-view="budget"] .sidebar {
  width: 240px;
  min-width: 240px;
}

.budget-sidebar-panels {
  display: none;
  flex-direction: column;
  gap: 0.9rem;
}

body[data-view="budget"] .budget-sidebar-panels {
  display: flex;
}

.template-list {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.template-empty {
  margin: 0;
  font-size: 0.8rem;
  color: #7a829e;
}

.budget-selector {
  display: flex;
  flex-direction: column;
  gap: 1.25rem;
}

.budget-selector__new {
  padding: 0.85rem 1.1rem;
  border-radius: 12px;
  border: none;
  background: #4e68d8;
  color: #f8f9ff;
  font-weight: 700;
  cursor: pointer;
}

.budget-selector__existing {
  display: flex;
  flex-direction: column;
  gap: 0.65rem;
}

.budget-selector__label {
  margin: 0;
  font-size: 0.85rem;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: #5b6482;
}

.budget-selector__list {
  display: flex;
  flex-direction: column;
  gap: 0.6rem;
}

.budget-selector__list button {
  padding: 0.6rem 0.75rem;
  border-radius: 10px;
  border: 1px solid #c8d1e3;
  background: #f8f9ff;
  font-weight: 600;
  cursor: pointer;
}

.sidebar__divider {
  border: none;
  border-top: 1px solid #e4e7ef;
  margin: 0;
}

.zoom-controls {
  display: flex;
  gap: 0.5rem;
}

.zoom-controls button {
  flex: 1;
}

.relationship-buttons {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 0.5rem;
}

.relationship-buttons button {
  font-size: 0.85rem;
}

.relationship-buttons button.is-active {
  border-color: #5d76d3;
  background: #e6ebff;
  color: #263a84;
}

.legend-item {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  font-size: 0.8rem;
  color: #3b4256;
}

.legend-swatch {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  display: inline-block;
}

.legend-swatch--class {
  background: var(--schema-class);
}

.legend-swatch--id {
  background: var(--schema-id);
}

.legend-swatch--attribute {
  background: var(--schema-attribute);
}

.legend-swatch--relationship {
  background: var(--schema-relationship);
}

.mini-toolbar {
  position: fixed;
  top: 1rem;
  right: 1rem;
  display: flex;
  gap: 0.75rem;
  align-items: flex-start;
  z-index: 10;
}

.mini-toolbar__section {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  background: rgba(255, 255, 255, 0.92);
  border: 1px solid #d6dcec;
  border-radius: 12px;
  padding: 0.5rem 0.65rem;
  box-shadow: 0 10px 24px rgba(31, 36, 48, 0.1);
  backdrop-filter: blur(6px);
}

.mini-toolbar__section--primary {
  gap: 0.65rem;
}

.mini-toolbar__section--primary button,
.mini-toolbar__section--view button {
  padding: 0.4rem 0.6rem;
  border-radius: 8px;
  border: 1px solid #c8d1e3;
  background: #f8f9ff;
  font-weight: 600;
  cursor: pointer;
}

.mini-toolbar__section--primary button:disabled,
.mini-toolbar__section--view button:disabled {
  cursor: not-allowed;
  opacity: 0.5;
}

.mini-toolbar__section--primary button.is-active,
.mini-toolbar__section--view button.is-active {
  border-color: #5d76d3;
  background: #e6ebff;
  color: #263a84;
}

.mini-toolbar__label {
  font-size: 0.7rem;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: #5b6482;
  font-weight: 600;
}

.mini-toolbar input[type="search"] {
  border-radius: 8px;
  border: 1px solid #c8d1e3;
  padding: 0.4rem 0.6rem;
  min-width: 200px;
  font-size: 0.85rem;
}

.view-toolbar {
  position: fixed;
  right: 1rem;
  bottom: 1rem;
  z-index: 10;
}

.mini-toolbar__section--view {
  position: relative;
  flex-direction: column;
  align-items: flex-start;
}

.view-toolbar__zoom {
  font-size: 0.75rem;
  font-weight: 700;
  color: #3b4256;
  background: rgba(255, 255, 255, 0.92);
  border: 1px solid #d6dcec;
  border-radius: 999px;
  padding: 0.25rem 0.6rem;
  margin-bottom: 0.4rem;
}

.view-options {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  margin-top: 0.35rem;
}

.view-options__buttons {
  display: flex;
  flex-direction: column;
  gap: 0.4rem;
}

.canvas {
  position: relative;
  flex: 1;
  overflow: auto;
  background: linear-gradient(180deg, #f8f9ff 0%, #eef1f8 100%);
}

.canvas::before {
  content: "";
  position: absolute;
  inset: 0;
  background-image: repeating-linear-gradient(
      0deg,
      rgba(31, 36, 48, 0.08) 0,
      rgba(31, 36, 48, 0.08) 1px,
      transparent 1px,
      transparent 20px
    ),
    repeating-linear-gradient(
      90deg,
      rgba(31, 36, 48, 0.08) 0,
      rgba(31, 36, 48, 0.08) 1px,
      transparent 1px,
      transparent 20px
    );
  opacity: 0;
  pointer-events: none;
  z-index: 0;
}

.canvas.canvas--grid::before {
  opacity: 0.45;
}

.canvas--linking {
  cursor: crosshair;
}

.canvas--linking .class-node {
  cursor: crosshair;
}

.canvas__lines {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 1;
}

.canvas__content {
  position: relative;
  width: 2400px;
  height: 1800px;
  transform-origin: 0 0;
}

.class-node {
  position: absolute;
  min-width: 220px;
  background: #ffffff;
  border: 1px solid #d2d8ea;
  border-top: 5px solid #d2d8ea;
  border-radius: 12px;
  box-shadow: 0 12px 24px rgba(31, 36, 48, 0.08);
  padding: 0.75rem;
  z-index: 2;
  cursor: grab;
}

.class-node.is-dragging {
  cursor: grabbing;
}

.class-node[data-selected="true"] {
  border-color: #5d76d3;
  box-shadow: 0 0 0 3px rgba(93, 118, 211, 0.2);
}

.class-node[data-active="true"] {
  border-color: #6c7dd6;
  box-shadow: 0 0 0 2px rgba(108, 125, 214, 0.15);
}

.class-node--multi-selected {
  border-color: #5d76d3;
  box-shadow: 0 0 0 3px rgba(93, 118, 211, 0.35);
}

.class-node.class-node--match {
  border-color: #f6a23c;
  box-shadow: 0 0 0 3px rgba(246, 162, 60, 0.25);
}

.class-node--subclass {
  border-top-color: var(--schema-subclass);
}

.class-node--subclass .class-node__title {
  background: var(--schema-subclass);
}

.class-node--instance {
  border-top-color: var(--schema-instance);
}

.class-node--instance .class-node__title {
  background: var(--schema-instance);
}

.class-node--core-instance {
  border-top-color: var(--schema-core-instance);
}

.class-node--core-instance .class-node__title {
  background: var(--schema-core-instance);
}

.class-node__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 0.5rem;
}

.class-node__title-wrap {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  flex: 1;
}

.type-dot {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: var(--schema-class);
  flex-shrink: 0;
  display: none;
}

.class-node__title {
  font-weight: 700;
  font-size: 1rem;
  outline: none;
  border: none;
  background: var(--schema-class);
  color: #1f2430;
  border-radius: 6px;
  padding: 0.2rem 0.4rem;
  flex: 1;
  min-width: 0;
  cursor: text;
}

.class-node__badge {
  font-size: 0.65rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  padding: 0.2rem 0.4rem;
  border-radius: 999px;
  background: #eef1fb;
  color: #3b4256;
  white-space: nowrap;
}

.class-node__meta {
  font-size: 0.75rem;
  color: #7a829e;
  margin-top: 0.25rem;
}

.class-node__actions {
  display: flex;
  gap: 0.35rem;
}

.class-node__actions button {
  border: none;
  background: #eef1fb;
  border-radius: 6px;
  padding: 0.2rem 0.4rem;
  cursor: pointer;
  font-size: 0.8rem;
}

.attributes {
  margin: 0.75rem 0 0;
  padding: 0;
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: 0.4rem;
}

.attribute {
  display: flex;
  align-items: center;
  gap: 0.4rem;
  background: #f5f7ff;
  border: 1px solid #e2e7f5;
  border-radius: 8px;
  padding: 0.3rem 0.45rem;
}

.attribute[data-inherited="true"] {
  box-shadow: inset 0 0 0 1px rgba(53, 82, 193, 0.45);
}

.attribute__marker {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: var(--schema-attribute);
  flex-shrink: 0;
  display: none;
}

.attribute__toggle {
  width: 14px;
  height: 14px;
  margin: 0;
  accent-color: #3552c1;
  cursor: pointer;
}

.attribute[data-attribute-type="id"] .attribute__marker {
  background: var(--schema-id);
}

.attribute[data-attribute-type="id"] {
  background: #fff3d8;
  border-color: #f3d9a4;
}

.attribute__name {
  flex: 1;
  outline: none;
  cursor: text;
  padding: 0.1rem 0.2rem;
  border-radius: 4px;
  background: transparent;
}

.attribute__value {
  min-width: 3.5rem;
  outline: none;
  cursor: text;
  padding: 0.1rem 0.4rem;
  border-radius: 999px;
  border: 1px dashed #cbd3ea;
  background: #ffffff;
  font-size: 0.75rem;
  color: #3b4256;
  white-space: nowrap;
}

.attribute__value:empty::before {
  content: attr(data-placeholder);
  color: #7a829e;
  font-style: italic;
}

.attribute__pill {
  border: 1px solid #cbd3ea;
  background: #f0f3ff;
  border-radius: 999px;
  padding: 0.15rem 0.5rem;
  font-size: 0.75rem;
  color: #3b4256;
  cursor: pointer;
  white-space: nowrap;
}

.attribute__pill:hover {
  border-color: #7f93d9;
  background: #e6ebff;
}

.attribute__pill.is-placeholder {
  color: #7a829e;
  font-style: italic;
}

.attribute__delete {
  border: none;
  background: transparent;
  cursor: pointer;
  color: #7c849d;
}

.attribute__delete:hover {
  color: #cc3f3f;
}

.attribute-popover {
  position: absolute;
  z-index: 10;
  background: #ffffff;
  border: 1px solid #d2d8ea;
  border-radius: 10px;
  padding: 0.5rem;
  min-width: 180px;
  box-shadow: 0 12px 24px rgba(31, 36, 48, 0.12);
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.relationship-popover__remove {
  border: none;
  background: #fbeaea;
  color: #b12525;
  font-weight: 600;
  border-radius: 8px;
  padding: 0.4rem 0.6rem;
  cursor: pointer;
  font-size: 0.85rem;
}

.relationship-popover__remove:hover {
  background: #f7d6d6;
}

.template-menu {
  position: absolute;
  z-index: 11;
  background: #ffffff;
  border: 1px solid #d2d8ea;
  border-radius: 10px;
  padding: 0.4rem;
  min-width: 160px;
  box-shadow: 0 12px 24px rgba(31, 36, 48, 0.12);
}

.template-menu button {
  width: 100%;
  border: none;
  background: #f3f5ff;
  border-radius: 6px;
  padding: 0.4rem 0.6rem;
  text-align: left;
  font-size: 0.85rem;
  cursor: pointer;
}

.template-menu button:hover {
  background: #e6ebff;
}

.template-menu button:disabled {
  cursor: not-allowed;
  opacity: 0.6;
}

.multi-grab-box {
  position: absolute;
  border: 2px dashed rgba(93, 118, 211, 0.8);
  background: rgba(93, 118, 211, 0.15);
  border-radius: 6px;
  pointer-events: none;
  z-index: 2;
}

.canvas--multi-grab {
  cursor: crosshair;
}

.attribute-popover__input {
  width: 100%;
  border-radius: 8px;
  border: 1px solid #ccd3e9;
  padding: 0.35rem 0.5rem;
  font-size: 0.8rem;
}

.attribute-popover__list {
  display: flex;
  flex-direction: column;
  gap: 0.35rem;
  max-height: 160px;
  overflow-y: auto;
}

.attribute-popover__option {
  border: none;
  background: #f3f5ff;
  border-radius: 6px;
  padding: 0.35rem 0.5rem;
  text-align: left;
  font-size: 0.8rem;
  cursor: pointer;
}

.attribute-popover__option:hover {
  background: #e6ebff;
}

.attribute-popover__empty,
.attribute-popover__hint {
  font-size: 0.75rem;
  color: #7a829e;
}

.relationship-popover__title {
  margin: 0;
  font-size: 0.75rem;
  font-weight: 700;
  color: #3b4256;
  text-transform: uppercase;
  letter-spacing: 0.04em;
}

.relationship-popover__row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 0.5rem;
  font-size: 0.8rem;
  color: #3b4256;
}

.relationship-popover__row input {
  margin: 0;
}

.relationship-popover__select {
  border-radius: 6px;
  border: 1px solid #cbd3ea;
  padding: 0.2rem 0.4rem;
  font-size: 0.8rem;
  background: #ffffff;
}

.add-attribute {
  margin-top: 0.5rem;
  border: none;
  background: #e6ebff;
  color: #3552c1;
  font-weight: 600;
  border-radius: 8px;
  padding: 0.35rem;
  cursor: pointer;
  width: 100%;
}

.add-subclass {
  margin-top: 0.35rem;
  border: none;
  background: #eef1fb;
  color: #3b4256;
  font-weight: 600;
  border-radius: 8px;
  padding: 0.35rem;
  cursor: pointer;
  width: 100%;
}

.collapsed .attributes,
.collapsed .add-attribute,
.collapsed .add-subclass,
.collapsed .system-attributes {
  display: none;
}

.system-attributes {
  margin: 0.45rem 0 0;
  font-size: 0.7rem;
  color: #7a829e;
}

.modal {
  position: absolute;
  top: 1.5rem;
  right: 1.5rem;
  width: 360px;
  max-height: calc(100vh - 3rem);
  background: #ffffff;
  border-radius: 12px;
  box-shadow: 0 16px 36px rgba(31, 36, 48, 0.12);
  padding: 1rem;
  z-index: 4;
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.modal[hidden] {
  display: none;
}

.modal--centered {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: min(420px, 90vw);
}

.modal__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 0.5rem;
  cursor: grab;
}

.modal__title {
  font-size: 1.1rem;
  margin: 0;
}

.modal__actions {
  display: inline-flex;
  gap: 0.35rem;
}

.modal__actions button {
  border: none;
  background: #eef1fb;
  border-radius: 6px;
  padding: 0.25rem 0.5rem;
  cursor: pointer;
  font-size: 0.8rem;
}

.modal__body {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.modal textarea {
  width: 100%;
  height: 60vh;
  resize: none;
  border-radius: 8px;
  border: 1px solid #ccd3e9;
  padding: 0.75rem;
  font-family: "SFMono-Regular", ui-monospace, SFMono-Regular, Menlo, monospace;
  font-size: 0.85rem;
}

.legend-list {
  display: flex;
  flex-direction: column;
  gap: 0.6rem;
}

.colors-form {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.colors-form__row {
  display: grid;
  grid-template-columns: 1fr 1.2fr auto;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.9rem;
  color: #3b4256;
}

.colors-form__row input {
  padding: 0.4rem 0.6rem;
  border-radius: 8px;
  border: 1px solid #ccd3e9;
  font-family: "SFMono-Regular", ui-monospace, SFMono-Regular, Menlo, monospace;
}

.colors-form__swatch {
  width: 20px;
  height: 20px;
  border-radius: 6px;
  border: 1px solid #ccd3e9;
  background: #f4f6fb;
}

.colors-form__actions {
  display: flex;
  justify-content: flex-end;
}

.colors-form__actions button {
  border: none;
  background: #3552c1;
  color: #ffffff;
  border-radius: 8px;
  padding: 0.45rem 0.9rem;
  font-weight: 600;
  cursor: pointer;
}

.colors-form__error {
  color: #cc3f3f;
  font-size: 0.85rem;
  min-height: 1rem;
  margin: 0;
}

.class-form {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.class-form__label {
  font-size: 0.9rem;
  color: #3b4256;
}

.class-form input {
  padding: 0.5rem 0.7rem;
  border-radius: 8px;
  border: 1px solid #ccd3e9;
  font-size: 0.95rem;
}

.class-form__actions {
  display: flex;
  justify-content: flex-end;
  gap: 0.5rem;
}

.class-form__actions button {
  border: none;
  background: #3552c1;
  color: #ffffff;
  border-radius: 8px;
  padding: 0.45rem 0.9rem;
  font-weight: 600;
  cursor: pointer;
}

.class-form__actions button#class-cancel {
  background: #eef1fb;
  color: #1f2430;
}

.class-form__error {
  color: #cc3f3f;
  font-size: 0.85rem;
  min-height: 1rem;
  margin: 0;
}

.relationship-label {
  fill: var(--schema-relationship);
  font-size: 12px;
  font-weight: 600;
  pointer-events: auto;
  cursor: pointer;
}

.relationship-line {
  stroke: var(--schema-relationship);
  pointer-events: stroke;
  cursor: pointer;
}

.relationship-line.is-active {
  stroke-width: 3.5;
  filter: drop-shadow(0 0 6px rgba(249, 110, 91, 0.6));
}

.relationship-label.is-active {
  fill: #f24c37;
  font-weight: 700;
}

.budget-view {
  display: none;
  height: 100%;
  padding: 2rem 2.25rem 3rem;
  overflow: auto;
}

body[data-view="budget"] .budget-view {
  display: block;
}

body[data-view="menu"] .sidebar,
body[data-view="menu"] .mini-toolbar,
body[data-view="menu"] .view-toolbar,
body[data-view="menu"] .canvas__content,
body[data-view="menu"] #relationship-lines,
body[data-view="menu"] .budget-view {
  display: none;
}

body[data-view="menu"] .main-menu {
  display: flex;
}

body[data-view="budget"] .canvas__content,
body[data-view="budget"] .view-toolbar,
body[data-view="budget"] #relationship-lines {
  display: none;
}

body[data-view="budget"] .mini-toolbar__section--view {
  display: none;
}

body[data-view="budget"] .mini-toolbar {
  top: auto;
  bottom: 1rem;
}

.budget-header {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  align-items: flex-start;
  gap: 1rem;
}

.budget-eyebrow {
  margin: 0 0 0.35rem;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  font-size: 0.75rem;
  color: #6b738c;
}

.budget-header h1 {
  margin: 0;
  font-size: 2rem;
}

.budget-subtitle {
  margin: 0.4rem 0 0;
  color: #57607a;
}

.budget-net-balance {
  display: grid;
  gap: 0.35rem;
  align-items: flex-end;
  justify-items: end;
  text-align: right;
}

.budget-net-balance span {
  text-transform: uppercase;
  letter-spacing: 0.08em;
  font-size: 0.7rem;
  color: #6b738c;
}

.budget-net-balance strong {
  font-size: 2.2rem;
  color: #1f2430;
}

.budget-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
}

.budget-actions button {
  padding: 0.5rem 0.85rem;
  border-radius: 8px;
  border: 1px solid #c8d1e3;
  background: #f8f9ff;
  font-weight: 600;
  cursor: pointer;
}

.budget-grid {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  grid-template-areas:
    "header header"
    "totals totals"
    "bills categories"
    "unintentional unintentional";
  gap: 1.25rem;
}

.budget-panel {
  background: #ffffff;
  border-radius: 16px;
  border: 1px solid #e4e7ef;
  padding: 1.1rem 1.25rem;
  box-shadow: 0 14px 28px rgba(31, 36, 48, 0.08);
}

.budget-panel--wide {
  grid-column: span 2;
}

.budget-panel--sidebar {
  padding: 0.9rem 1rem;
}

.budget-header {
  grid-area: header;
}

#budget-totals-panel {
  grid-area: totals;
}

#budget-bills-panel {
  grid-area: bills;
}

#budget-categories-panel {
  grid-area: categories;
}

#budget-unintentional-panel {
  grid-area: unintentional;
}

.budget-panel__header {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  justify-content: space-between;
  gap: 1rem;
  margin-bottom: 1rem;
}

.budget-panel__header h2,
.budget-panel__header h3 {
  margin: 0;
  font-size: 1.1rem;
}

.budget-panel__actions {
  display: inline-flex;
  gap: 0.5rem;
  flex-wrap: wrap;
}

.budget-panel__actions button {
  padding: 0.35rem 0.7rem;
  border-radius: 999px;
  border: 1px solid #c8d1e3;
  background: #f8f9ff;
  font-weight: 600;
  cursor: pointer;
}

.budget-totals {
  display: grid;
  gap: 0.8rem;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
}

.budget-total-card {
  padding: 0.9rem;
  background: #f7f8fe;
  border-radius: 12px;
  border: 1px solid #e1e6f6;
}

.budget-total-card span {
  display: block;
  font-size: 0.8rem;
  color: #5d667f;
}

.budget-total-card strong {
  font-size: 1.4rem;
  margin-top: 0.35rem;
  display: block;
}

.budget-table {
  display: flex;
  flex-direction: column;
  gap: 0.6rem;
}

.budget-category-group {
  display: grid;
  gap: 0.35rem;
}

.budget-category-transactions {
  display: grid;
  gap: 0.35rem;
  margin-left: 0.8rem;
  padding-left: 0.8rem;
  border-left: 2px dashed #d4daee;
}

.budget-category-group.is-collapsed .budget-category-transactions {
  display: none;
}

.budget-row--category-transaction {
  grid-template-columns: 1.6fr 0.9fr 0.8fr 0.5fr;
  background: #f5f7ff;
  border-radius: 10px;
  padding: 0.45rem 0.6rem;
  border: 1px solid #e1e6f6;
}

.budget-row {
  display: grid;
  grid-template-columns: repeat(4, minmax(0, 1fr));
  gap: 0.75rem;
  align-items: center;
}

.budget-row--bills {
  grid-template-columns: 1.4fr 0.9fr 0.9fr 0.8fr 0.6fr;
}

.budget-row--categories {
  grid-template-columns: 1.5fr 0.9fr 0.9fr 0.5fr;
}

.budget-row--summary {
  grid-template-columns: 1.4fr 0.9fr 0.8fr 0.9fr 0.5fr;
}

.budget-row--header {
  font-size: 0.8rem;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  color: #6b738c;
}

.budget-row input[type="text"],
.budget-row input[type="number"],
.budget-form input,
.budget-form select {
  width: 100%;
  padding: 0.45rem 0.6rem;
  border-radius: 8px;
  border: 1px solid #c8d1e3;
  background: #f8f9ff;
  font: inherit;
}

.budget-row button,
.budget-form button {
  padding: 0.45rem 0.7rem;
  border-radius: 8px;
  border: 1px solid #c8d1e3;
  background: #f8f9ff;
  font-weight: 600;
  cursor: pointer;
}

.budget-row__actions {
  display: inline-flex;
  gap: 0.4rem;
  justify-content: flex-end;
}

.budget-row__toggle {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
}

.budget-form {
  margin-top: 0.8rem;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 0.6rem;
  align-items: center;
}

.budget-form--inline {
  grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
  margin-top: 0.75rem;
}

.budget-form--bills {
  grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
}

.budget-form__field {
  display: grid;
  gap: 0.3rem;
}

.budget-filter {
  display: flex;
  gap: 0.5rem;
}

.budget-filter button {
  padding: 0.4rem 0.7rem;
  border-radius: 8px;
  border: 1px solid #c8d1e3;
  background: #f8f9ff;
  font-weight: 600;
  cursor: pointer;
}

.budget-filter button.is-active {
  border-color: #5d76d3;
  background: #e6ebff;
  color: #263a84;
}

.budget-unintentional {
  display: grid;
  gap: 0.6rem;
}

.budget-unintentional__summary {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: #fdf4f0;
  border-radius: 12px;
  padding: 0.75rem 1rem;
  border: 1px solid #f3d2c6;
}

.budget-unintentional__list {
  display: grid;
  gap: 0.5rem;
}

.budget-unintentional__item {
  display: grid;
  grid-template-columns: auto minmax(0, 1fr) auto;
  gap: 0.6rem;
  align-items: center;
  font-size: 0.9rem;
  color: #5a6278;
}

.budget-unintentional__assign-toggle {
  padding: 0.35rem 0.6rem;
  border-radius: 8px;
  border: 1px solid #c8d1e3;
  background: #f8f9ff;
  font-weight: 600;
  cursor: pointer;
}

.budget-unintentional__details {
  display: grid;
  gap: 0.3rem;
}

.budget-unintentional__assign {
  display: none;
  gap: 0.4rem;
  align-items: center;
}

.budget-unintentional__item.is-assigning .budget-unintentional__assign {
  display: flex;
}

.budget-unintentional__assign select {
  flex: 1;
  padding: 0.35rem 0.5rem;
  border-radius: 8px;
  border: 1px solid #c8d1e3;
  background: #f8f9ff;
  font: inherit;
}

.budget-transactions {
  display: grid;
  gap: 0.75rem;
}

.budget-transaction {
  display: grid;
  grid-template-columns: 1.4fr 1.2fr 0.7fr 0.7fr 0.6fr;
  gap: 0.6rem;
  padding: 0.75rem 0.9rem;
  border-radius: 12px;
  border: 1px solid #e1e6f6;
  background: #f8f9ff;
  align-items: center;
}

.budget-transaction.is-reviewed {
  background: #e9f6ef;
  border-color: #bfe6cd;
}

.budget-transaction__meta {
  display: grid;
  gap: 0.2rem;
}

.budget-transaction__meta strong {
  font-size: 0.95rem;
}

.budget-transaction__meta span {
  font-size: 0.8rem;
  color: #667089;
}

.budget-transaction__tag {
  font-size: 0.85rem;
  font-weight: 600;
  color: #38405a;
}

.budget-transaction__amount {
  font-weight: 700;
  text-align: right;
}

.budget-transaction__assign {
  display: grid;
  gap: 0.4rem;
}

.budget-transaction__assign label {
  display: grid;
  gap: 0.2rem;
  font-size: 0.75rem;
  color: #667089;
}

.budget-transaction__assign select,
.budget-transaction__assign button {
  width: 100%;
  padding: 0.45rem 0.6rem;
  border-radius: 8px;
  border: 1px solid #c8d1e3;
  background: #f8f9ff;
  font: inherit;
}

.budget-transaction__assign button {
  transition: transform 0.1s ease, box-shadow 0.1s ease, background 0.1s ease;
}

.budget-transaction__assign button:hover {
  background: #eef1fb;
}

.budget-transaction__assign button:active {
  transform: translateY(1px);
  box-shadow: inset 0 1px 2px rgba(15, 23, 42, 0.2);
}

.budget-transaction__assign button.is-feedback {
  background: #e9f6ef;
  border-color: #bfe6cd;
  color: #1f6b3b;
}

.budget-transaction__assign button:disabled {
  opacity: 0.7;
  cursor: default;
}

.budget-transaction__status {
  display: block;
  min-height: 1rem;
  font-size: 0.75rem;
  color: #58627a;
}

.budget-transaction__status.is-success {
  color: #1f6b3b;
  font-weight: 600;
}

.budget-transaction__status.is-error {
  color: #c0352b;
  font-weight: 600;
}

.budget-transaction__actions {
  display: flex;
  gap: 0.4rem;
  justify-content: flex-end;
}

@media (max-width: 1100px) {
  body[data-view="budget"] .sidebar {
    width: 220px;
    min-width: 220px;
  }
}

@media (max-width: 960px) {
  .budget-view {
    padding: 1.5rem;
  }

  .budget-grid {
    grid-template-columns: minmax(0, 1fr);
    grid-template-areas:
      "header"
      "totals"
      "bills"
      "categories"
      "unintentional";
  }

  .budget-panel--wide {
    grid-column: auto;
  }
}

:root[data-theme="dark"] {
  color-scheme: dark;
  background: #141826;
  color: #e2e7f5;
}

:root[data-theme="dark"] body {
  background: #141826;
}

:root[data-theme="dark"] .sidebar {
  background: #1a2031;
  border-right-color: #2a3147;
}

:root[data-theme="dark"] .sidebar__brand {
  color: #f0f3ff;
}

:root[data-theme="dark"] .sidebar button,
:root[data-theme="dark"] .mini-toolbar__section--primary button,
:root[data-theme="dark"] .mini-toolbar__section--view button {
  background: #242b3f;
  border-color: #3a4566;
  color: #e2e7f5;
}

:root[data-theme="dark"] .sidebar button:hover,
:root[data-theme="dark"] .mini-toolbar__section--primary button:hover,
:root[data-theme="dark"] .mini-toolbar__section--view button:hover {
  border-color: #5c6fb8;
}

:root[data-theme="dark"] .sidebar__label,
:root[data-theme="dark"] .sidebar__status,
:root[data-theme="dark"] .template-empty,
:root[data-theme="dark"] .legend-item,
:root[data-theme="dark"] .mini-toolbar__label,
:root[data-theme="dark"] .class-node__meta,
:root[data-theme="dark"] .system-attributes {
  color: #b9c2dd;
}

:root[data-theme="dark"] .sidebar__divider {
  border-top-color: #2a3147;
}

:root[data-theme="dark"] .main-menu {
  background: radial-gradient(circle at top, #1b1f2d 0%, #161a27 55%, #10131f 100%);
}

:root[data-theme="dark"] .main-menu__panel {
  background: rgba(24, 28, 42, 0.96);
  border-color: #2a3042;
  box-shadow: 0 24px 48px rgba(0, 0, 0, 0.4);
}

:root[data-theme="dark"] .main-menu__panel h1,
:root[data-theme="dark"] .main-menu__subtitle {
  color: #e5e9f6;
}

:root[data-theme="dark"] .main-menu__eyebrow,
:root[data-theme="dark"] .main-menu__options h2 {
  color: #9aa5c4;
}

:root[data-theme="dark"] .main-menu__button {
  background: #1f2433;
  color: #e5e9f6;
}

:root[data-theme="dark"] .main-menu__option-row {
  background: #22283a;
  color: #e5e9f6;
}

:root[data-theme="dark"] .main-menu__option-row button {
  background: #1b1f2d;
  border-color: #2f3446;
  color: #e5e9f6;
}

:root[data-theme="dark"] .mini-toolbar__section {
  background: rgba(26, 32, 49, 0.92);
  border-color: #2a3147;
  box-shadow: 0 10px 24px rgba(5, 8, 16, 0.5);
}

:root[data-theme="dark"] .view-toolbar__zoom {
  background: rgba(26, 32, 49, 0.92);
  border-color: #2a3147;
  color: #e2e7f5;
}

:root[data-theme="dark"] .canvas {
  background: linear-gradient(180deg, #141826 0%, #101422 100%);
}

:root[data-theme="dark"] .class-node {
  background: #1f2639;
  border-color: #2b344d;
  box-shadow: 0 12px 24px rgba(5, 8, 16, 0.45);
}

:root[data-theme="dark"] .class-node[data-selected="true"] {
  border-color: #7f8ff0;
  box-shadow: 0 0 0 3px rgba(127, 143, 240, 0.4);
}

:root[data-theme="dark"] .class-node[data-active="true"] {
  border-color: #9aa7ff;
  box-shadow: 0 0 0 2px rgba(154, 167, 255, 0.35);
}

:root[data-theme="dark"] .class-node--multi-selected {
  border-color: #7f8ff0;
  box-shadow: 0 0 0 3px rgba(127, 143, 240, 0.45);
}

:root[data-theme="dark"] .attribute {
  background: #242b3f;
  border-color: #323b55;
}

:root[data-theme="dark"] .attribute[data-attribute-type="id"] {
  background: #3a2d12;
  border-color: #5a4320;
}

:root[data-theme="dark"] .attribute__value {
  background: #1f2639;
  border-color: #3a4566;
  color: #e2e7f5;
}

:root[data-theme="dark"] .attribute__pill {
  background: #2a3147;
  border-color: #3a4566;
  color: #e2e7f5;
}

:root[data-theme="dark"] .attribute__pill:hover {
  background: #334062;
  border-color: #5c6fb8;
}

:root[data-theme="dark"] .class-node__actions button,
:root[data-theme="dark"] .modal__actions button,
:root[data-theme="dark"] .class-form__actions button#class-cancel {
  background: #2a3147;
  color: #e2e7f5;
}

:root[data-theme="dark"] .modal {
  background: #1a2031;
  box-shadow: 0 16px 36px rgba(5, 8, 16, 0.6);
}

:root[data-theme="dark"] .modal textarea,
:root[data-theme="dark"] .colors-form__row input,
:root[data-theme="dark"] .class-form input {
  background: #1f2639;
  border-color: #2b344d;
  color: #e2e7f5;
}

:root[data-theme="dark"] .colors-form__swatch {
  background: #2a3147;
  border-color: #3a4566;
}

:root[data-theme="dark"] .attribute-popover {
  background: #1a2031;
  border-color: #2a3147;
  box-shadow: 0 12px 24px rgba(5, 8, 16, 0.6);
}

:root[data-theme="dark"] .template-menu {
  background: #1a2031;
  border-color: #2a3147;
  box-shadow: 0 12px 24px rgba(5, 8, 16, 0.6);
}

:root[data-theme="dark"] .template-menu button {
  background: #2a3147;
  color: #e2e7f5;
}

:root[data-theme="dark"] .template-menu button:hover {
  background: #334062;
}

:root[data-theme="dark"] .relationship-popover__remove {
  background: #3a1f25;
  color: #f2b4b4;
}

:root[data-theme="dark"] .relationship-popover__remove:hover {
  background: #4a252c;
}

:root[data-theme="dark"] .multi-grab-box {
  border-color: rgba(143, 168, 255, 0.8);
  background: rgba(93, 118, 211, 0.2);
}

:root[data-theme="dark"] .attribute-popover__input {
  background: #1f2639;
  border-color: #2b344d;
  color: #e2e7f5;
}

:root[data-theme="dark"] .attribute-popover__option {
  background: #2a3147;
  color: #e2e7f5;
}

:root[data-theme="dark"] .attribute-popover__option:hover {
  background: #334062;
}

:root[data-theme="dark"] .budget-view {
  background: transparent;
}

:root[data-theme="dark"] .budget-eyebrow,
:root[data-theme="dark"] .budget-subtitle,
:root[data-theme="dark"] .budget-total-card span,
:root[data-theme="dark"] .budget-row--header,
:root[data-theme="dark"] .budget-transaction__meta span {
  color: #b9c2dd;
}

:root[data-theme="dark"] .budget-net-balance strong {
  color: #f8f9ff;
}

:root[data-theme="dark"] .budget-actions button,
:root[data-theme="dark"] .budget-row input[type="text"],
:root[data-theme="dark"] .budget-row input[type="number"],
:root[data-theme="dark"] .budget-form input,
:root[data-theme="dark"] .budget-form select,
:root[data-theme="dark"] .budget-row button,
:root[data-theme="dark"] .budget-unintentional__assign-toggle,
:root[data-theme="dark"] .budget-unintentional__assign select,
:root[data-theme="dark"] .budget-form button,
:root[data-theme="dark"] .budget-transaction__assign select,
:root[data-theme="dark"] .budget-transaction__assign button,
:root[data-theme="dark"] .budget-panel__actions button,
:root[data-theme="dark"] .budget-filter button {
  background: #242b3f;
  border-color: #3a4566;
  color: #e2e7f5;
}

:root[data-theme="dark"] .budget-panel {
  background: #1a2031;
  border-color: #2a3147;
  box-shadow: 0 16px 32px rgba(5, 8, 16, 0.45);
}

:root[data-theme="dark"] .budget-total-card {
  background: #242b3f;
  border-color: #323b55;
}

:root[data-theme="dark"] .budget-filter button.is-active {
  background: #2b365f;
  border-color: #5c6fb8;
  color: #e2e7f5;
}

:root[data-theme="dark"] .budget-selector__new {
  background: #5d76d3;
  color: #f0f2fb;
}

:root[data-theme="dark"] .budget-selector__list button {
  background: #242b3f;
  border-color: #3a4566;
  color: #e2e7f5;
}

:root[data-theme="dark"] .budget-unintentional__summary {
  background: #34262a;
  border-color: #5a3a42;
  color: #e9c7c7;
}

:root[data-theme="dark"] .budget-category-transactions {
  border-left-color: #2d3454;
}

:root[data-theme="dark"] .budget-row--category-transaction {
  background: #1c2236;
  border-color: #2d3454;
}

:root[data-theme="dark"] .budget-transaction {
  background: #242b3f;
  border-color: #2b344d;
}

:root[data-theme="dark"] .budget-transaction.is-reviewed {
  background: #1f2f2a;
  border-color: #2f4a3e;
}

:root[data-theme="dark"] .budget-transaction__tag {
  color: #d4dbf5;
}

:root[data-theme="dark"] .budget-transaction__status {
  color: #a8b2c7;
}

:root[data-theme="dark"] .budget-transaction__status.is-success {
  color: #7ad9a0;
}

:root[data-theme="dark"] .budget-transaction__status.is-error {
  color: #ff8e86;
}
